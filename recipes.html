<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="Thomas Brace">
  <title>Bubble & Squeak Kids' Kitchen</title>

  <!-- Bootstrap core CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="img/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png">
  <link rel="manifest" href="img/site.webmanifest">
  <link rel="mask-icon" href="img/safari-pinned-tab.svg" color="#fcfda4">
  <meta name="msapplication-TileColor" content="#fcfda4">
  <meta name="theme-color" content="#fcfda4">

  <style>
      .navbar
      {
        background-color: #fcfda4 !important;
      }
      .navbar #logo {
        height: 100px;
        transition: 0.4s;
      }
      .featurette .frame{
        overflow: hidden;
        position: relative;
        padding-bottom: 100%;
      }
      .frame img{
        position: absolute;
        height: 100%;
      }
    </style>
    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-159951151-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-159951151-1');
    </script>

    <link rel="stylesheet" type="text/css" href="//wpcc.io/lib/1.0.2/cookieconsent.min.css"/>
    <script src="//wpcc.io/lib/1.0.2/cookieconsent.min.js"></script>
    <script>window.addEventListener("load", function(){window.wpcc.init({"border":"thin","corners":"small","colors":{"popup":{"background":"#fcfda4","text":"#5a5a5a","border":"#e0bc57"},"button":{"background":"#f6cdf3","text":"#5a5a5a"}},"position":"bottom","content":{"href":"https://www.bubbleandsqueakkids.com/cookies.html"}})});</script>


</head>

<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow fixed-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <img id="logo" src="img/B&S_Full_Transparent.png" alt="Bubble and Squeak log">
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active">
            <a class="nav-link" href="index.html">Home
              <span class="sr-only">(current)</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="AfterSchool.html">After School Clubs</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="PreSchoolers.html">Pre-Schoolers</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="HolidayClubs.html">Holiday Workshops</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="Parties.html">Parties</a>
          </li>

        </ul>
      </div>
    </div>
  </nav>

  <main>
    <!-- Full Page Image Header with Vertically Centered Content -->
    <div class="container marketing">

      <hr class="featurette-divider">
      <hr class="featurette-divider">
      <h2 class="featurette-heading">Recipes</h2>

      <div class="featurette row text-center text-lg-left">

        <div class="filters row ml-3">
        </div>

        <hr class="featurette-divider">

        <div class="recipes card-columns">

        </div>
      </div>

      <hr class="featurette-divider">

    </div><!-- /.container -->
  </main>


  <!-- FOOTER -->
  <footer class="page-footer pt-4 bg-dark text-white">
    <div class="container">
      <div class="row">
        <div class="col-12 col-md">
          <img class="social" src="img/favicon.ico">
          <ul class="list-unstyled text-small">
            <li><span class="text-muted">&copy; 2019-2020 Bubble & Squeak Kids Kitchen.</span></li>
          </ul>
        </div>
        <div class="col-12 col-md">
          <h5>Contact</h5>
          <ul class="list-unstyled text-small">
            <li>
              <a class="text-muted" href="mailto:ruth@bubbleandsqueakkids.com?subject=Enquiry">
                <img src="img/Email_White.png" class="social" alt="Email Icon">ruth@bubbleandsqueakkids.com
              </a>
            </li>
            <li>
              <a class="text-muted" href="https://www.facebook.com/Bubble-Squeak-Kids-Kitchen-102917904617053/" target="_blank">
                <img src="img/f_logo_RGB-White_58.png" class="social" alt="Facebook Icon">Bubble-Squeak-Kids-Kitchen
              </a>
            </li>
            <li>
              <a class="text-muted" href="https://www.instagram.com/bubbleandsqueakkids" target="_blank">
                <img src="img/glyph-logo_May2016_White.png" class="social" alt="instagram Icon">bubbleandsqueakkids
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </footer>
  <!-- Bootstrap's js requires jquery - needed for the nav bar collapse -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  <script type="text/javascript" language="javascript" src="recipes/recipes.json"></script>
  <script>
    // When the user scrolls down 80px from the top of the document, resize logo size
    window.onscroll = function() {
      scrollFunction()
    };

    function scrollFunction() {
      if (document.body.scrollTop > 80 || document.documentElement.scrollTop > 80) {
        document.getElementById("logo").style.height = "50px";
      } else {
        document.getElementById("logo").style.height = "100px";
      }
    }

    $( document ).ready(function() {
      buildTags();
      buildList();

    });

    function buildTags(){
      var filters = [];
      var tags = [];
      var tagsHtml = "";
      for (i = 0; i < recipes.recipe.length; i++) {
        if (recipes.recipe[i].active) {
          tags = tags.concat(recipes.recipe[i].tags);
          tags = removeDuplicates(tags);
        }
      }
      for (i = 0; i < tags.length; i++) {
        tagsHtml += "<div class='btn-group-toggle mr-2 mt-2 mb-2' data-toggle='buttons'>";
        tagsHtml += "<label class='btn btn-outline-secondary btn-sm'>";
        tagsHtml += "<input class='filterButton' data-value=" + tags[i] + " type='checkbox'> #" + tags[i];
        tagsHtml += "</label>";
        tagsHtml += "</div>";
      }
      $(".filters").append(tagsHtml);

      // bind click event
      $(".filterButton").click(function() {
        var attrName = $(this).attr("data-value");
        var selected = $(this).parent().hasClass("active")
        if(!selected) {
          filters.push(attrName)
        } else {
          filters.remove(attrName)
        }
  console.log(filters);
        buildList(filters)
      });
    }

    function cardHTMl(i){
      var html = "";
      html += "<div class='card text-center'>";
      html +=    "<a target='_blank' href='recipes/pdf/" + recipes.recipe[i].name + ".pdf'>"
      html +=      "<img class='card-img-top' src='recipes/thumb/" + recipes.recipe[i].name + ".png' alt='" + recipes.recipe[i].name + "'>";
      html +=    "</a>";
      html +=    "<div class='card-body'>";
      html +=      "<h5 class='card-title'>" + recipes.recipe[i].name + "</h5>";
      html +=      "<p class='card-text'>" + recipes.recipe[i].description + "</p>";
      if (recipes.recipe[i].tags.length > 0){
        html += "<p class='card-text'>"
        for (x = 0; x < recipes.recipe[i].tags.length; x++) {
          html += "<small class='text-muted'>#" + recipes.recipe[i].tags[x] + " </small>"
        }
        html += "</p>"
      }
      html +=      "</div>";
      html += "</div>";
      return html;
    }

    function buildList(filter){
      var recipesHtml = ""
      $(".recipes").html("");
      // loop through recipes
      for (i = 0; i < recipes.recipe.length; i++) {
        if (recipes.recipe[i].active) {
          if (filter) {
            if (filter.length > 0) {
              if (findOne(filter,recipes.recipe[i].tags)) {
                recipesHtml += cardHTMl(i);
              }
            } else {
              recipesHtml += cardHTMl(i);
            }
          } else {
            recipesHtml += cardHTMl(i);
          }
        }
      }
      $(".recipes").append(recipesHtml);
    }

    // helper JS

    function removeDuplicates(array) {
      return array.filter((a, b) => array.indexOf(a) === b)
    };

    Array.prototype.remove = function() {
        var what, a = arguments, L = a.length, ax;
        while (L && this.length) {
            what = a[--L];
            while ((ax = this.indexOf(what)) !== -1) {
                this.splice(ax, 1);
            }
        }
        return this;
    };

    /**
     * @description determine if an array contains one or more items from another array.
     * @param {array} haystack the array to search.
     * @param {array} arr the array providing items to check for in the haystack.
     * @return {boolean} true|false if haystack contains at least one item from arr.
     */
    var findOne = function (haystack, arr) {
        return arr.some(function (v) {
            return haystack.indexOf(v) >= 0;
        });
    };
  </script>
</body>
<p class='card-text'><small class='text-muted'>Last updated 3 mins ago</small></p>
</html>
